import * as Highcharts from "highcharts/highmaps";
import "./helpers/jquery"; // https://hexquote.com/import-jquery-and-jquery-ui-using-parcel-js/
import "jquery-ui-bundle";

const eventClickPopup = function (this: Highcharts.Series, ctx: Highcharts.SeriesClickEventObject) {
  let $div = $("<div></div>").dialog({
    title: ctx.point.name,
    width: 320,
    height: 300,
  });

  Highcharts.chart($div[0], {
    legend: { enabled: false },
    chart: {
      plotBackgroundColor: undefined,
      plotBorderWidth: undefined,
      plotShadow: false,
      type: "pie",
    },
    title: {
      text: "",
    },
    tooltip: {
      pointFormat: "{series.name}: <b>{point.percentage:.1f}%</b>",
    },
    accessibility: {
      point: {
        valueSuffix: "%",
      },
    },
    plotOptions: {
      pie: {
        allowPointSelect: true,
        cursor: "pointer",
        dataLabels: {
          enabled: false,
        },
        showInLegend: true,
      },
    },
    series: [
      {
        events: {
          click: eventClickRedirect.bind(this),
        },
        type: "pie",
        name: "Partai",
        colorByPoint: true,
        data: [
          {
            name: "Gerindra",
            y: 61.41,
            color: "#FFCA03",
          },
          {
            name: "Partai 1",
            y: 11.84,
          },
          {
            name: "Partai 2",
            y: 10.85,
          },
          {
            name: "Partai 3",
            y: 4.67,
          },
          {
            name: "Partai 4",
            y: 4.18,
          },
          {
            name: "Lainnya",
            y: 7.05,
          },
        ],
      },
    ],
  });
};

const eventClickRedirect = function (this: Highcharts.Series, ctx: Highcharts.SeriesClickEventObject) {
  // console.log(ctx, this.data[0].name);
  window.open("http://www.google.com/")
};

// Initiate the chart
Highcharts.mapChart("container", {
  credits: {enabled: false},
  title: { text: "Kota Kendari" },
  series: [
    {
      events: {
        click: eventClickPopup,
      },
      name: "DAPIL-1",
      color: "#CDB699",
      tooltip: {
        headerFormat: "",
        pointFormat: "{point.name}",
      },
      type: "map",
      joinBy: "id",
      mapData: [
        {
          id: "id1",
          name: "DAPIL-1",
          path: "M404,179,456,198,471,206,504,208,634,200,694,207,780,239,813,238,809,249,813,265,810,270,810,276L806,276L806,278,799,280,797,278,789,289,785,286,783,288,780,287,771,293,768,290,766,291,764,290,759,290,756,291,751,290,746,291,744,292,744,297,748,297,751,308,753,308,753,310,747,315,745,324,730,324,729,323,717,333,719,337,714,343,714,346,708,356,699,354,698,350,686,351,679,344,680,337,678,332L677,332L676,335,668,329,671,326,670,326,667,326,666,323,663,324,661,340,647,337,636,327,630,327,630,331,624,330,623,332,615,332,608,324,608,327,598,327,599,323,574,318,573,320,559,311,533,308,532,310,530,308,518,307,511,309,508,311,504,306,479,303,460,306,457,309,449,313,448,315,434,320,435,325,438,324,439,327,440,333,423,323,418,313,404,306,411,289,409,288,409,284L410,284L412,251,404,252,392,239,397,231,397,224,401,219z",
        },
      ],
      data: [
        {
          id: "id1",
          value: 212,
        },
      ],
    },
    {
      events: {
        click: eventClickPopup,
      },
      name: "DAPIL-2",
      color: "#FF9F45",
      tooltip: {
        headerFormat: "",
        pointFormat: "{point.name}",
      },
      type: "map",
      joinBy: "id",
      mapData: [
        {
          id: "id2",
          name: "DAPIL-2",
          path: "M452,362,457,362,457,365,460,367,457,369,457,371L461,371L462,377,458,379L458,383L456,384,456,395,458,397,460,396,465,399,479,395,494,400,501,398,503,400,516,404,516,411,520,408,524,410,531,396,531,390,536,386,541,387,551,380,558,379,559,381,564,379,564,375,569,375,580,371,577,376,580,376,580,374,590,376,592,371,594,371,596,369,603,368,603,362,607,362,608,367,610,367,612,375,616,375,613,373,617,369,628,368,628,363,630,363,630,367,635,366,638,362,646,361,646,359,644,359,644,357,645,356,649,356L649,358L651,358,653,356,654,358,656,358L656,360L660,360,659,362,658,363,658,364,659,364,659,366,657,367,657,368,660,368,664,361C664,361,668,361,668,361,668,361,668,352,668,352L671,352,671,355,674,355,675,357,680,356,681,358,685,359,681,360,681,362,686,365,695,365,695,364,698,364,698,366,703,371,703,374,708,378,725,378,729,380,733,389,735,388,741,395,740,406,745,405,749,410,749,414,755,417,758,416,763,422L763,426L773,428,776,430,776,434,785,446,788,451,799,449,809,445,819,442,821,444,821,447,823,449,823,453,821,456,823,462,835,450,850,452,856,451,860,456,862,454,864,454,864,460,867,460,879,450L898,450L902,447,908,447,912,449,898,467,880,481,867,499,859,504,852,512,834,519,829,519,781,532,773,539,740,617,715,684,696,740,691,742,693,745,668,770,640,768,635,770,614,764,610,754,612,713,606,710,515,740,506,741C506,741,493,713,493,713L492,707,494,701,501,693,500,677,504,668,518,668,528,657,541,651,558,637,559,629L559,629L555,625,542,619,531,605,516,571,506,569,495,563,491,558,487,558,478,548,470,543,456,507,457,501,449,436,448,409,452,400,445,371z,M708,370,710,368,709,365,714,363,720,354,723,346,725,346,726,345,726,344,728,343,735,347,739,347,741,345,745,346,747,348,751,348,751,349L755,349L759,353,758,355,756,356L756,358L758,361L762,361L762,363,759,363,760,371,765,375,770,375,771,376L773,376L780,382,780,388,783,392,783,395,784,397,784,398,783,399,782,402,768,407,767,404,763,404,760,407,754,408,754,402,755,398,752,395,752,394,754,393,754,390,750,382,751,379L748,379L738,374L738,371L737,371,735,372,731,372,730,371,727,371,726,369,726,369,722,372,715,372,715,373,707,372z",
        },
      ],
      data: [
        {
          id: "id2",
        },
      ],
    },
    {
      events: {
        click: eventClickPopup,
      },
      color: "#00B4D8",
      name: "DAPIL-3",
      tooltip: {
        headerFormat: "",
        pointFormat: "{point.name}",
      },
      type: "map",
      joinBy: "id",
      mapData: [
        {
          id: "id3",
          name: "DAPIL-3",
          path: "M80,501,81,511,94,525,119,535,168,546,182,554,197,565,201,569,224,621,226,622,243,653,261,641,315,718,372,706,342,763,346,768,350,768,355,775,378,776,376,780,390,786,390,788,400,789,403,794,412,793,418,798,423,798,430,794,441,777,506,741,502,730,493,713,492,707,494,701,501,693,500,677,504,668,518,668,528,657,541,651,558,637,559,629C559,629,556,625,555,625,554,625,542,619,542,619L531,605,516,571,506,569,495,563,491,558,487,558,478,548,470,543,456,507,457,501,449,436,448,409,452,400,445,371,452,362,450,354,448,354,447,355,443,353,434,359,419,357,416,361,394,393,384,403,385,414,383,418,381,416,377,420,373,418,373,420,363,428,365,435,370,433,369,444,364,446,363,449,369,457,363,462,358,461,359,467,361,468,363,466,367,471,369,465,373,474,371,476,310,491,281,489,260,484,212,456,189,435,158,444,148,456L148,476L146,488,142,499,139,505,112,519,99,510z",
        },
      ],
      data: [
        {
          id: "id3",
          color: "#00B4D8",
        },
      ],
    },
    {
      events: {
        click: eventClickPopup,
      },
      name: "DAPIL-4",
      color: "#94B49F",
      tooltip: {
        headerFormat: "",
        pointFormat: "{point.name}",
      },
      type: "map",
      joinBy: "id",
      mapData: [
        {
          id: "id4",
          name: "DAPIL-4",
          path: "M189,435,212,456,260,484,281,489,310,491,371,476,373,474,369,465,367,471,363,466,361,468,359,467,358,461,363,462,369,457,363,449,364,446,369,444,370,433,365,435,363,428,373,420,373,418,377,420,381,416,383,418,385,414,384,403,394,393,407,374,416,361,353,332,350,334,340,328,328,337,327,339,325,339,323,338,322,335,319,335,315,333,315,330,310,330,310,325,301,322,299,326,297,325,296,331,295,337,288,333,263,360,264,362,248,375,235,409z",
        },
      ],
      data: [
        {
          id: "id4",
        },
      ],
    },
    {
      events: {
        click: eventClickPopup,
      },
      name: "DAPIL-5",
      color: "#FF5C8D",
      tooltip: {
        headerFormat: "",
        pointFormat: "{point.name}",
      },
      type: "map",
      joinBy: "id",
      mapData: [
        {
          id: "id5",
          name: "DAPIL-5",
          path: "M404,179,341,79,240,80,191,118,125,203,127,306,77,483,80,490,80,501,99,510,112,519,139,505,142,499,146,488,148,476L148,456L158,444,189,435,235,409,248,375,264,362,263,360,279,344,288,333,295,337,296,331,297,325,299,326,301,322,310,325,310,330,315,330,315,333,319,335,322,335,323,338,325,339,327,339,328,337,340,328,350,334,353,332,416,361,419,357,434,359,443,353,448,348,449,344,446,341L442,341L439,337,443,334,445,330,443,330,440,333,437,332,423,323,418,313,404,306,411,289,409,288,409,284L410,284L412,251,404,252,392,239,397,231,397,224,401,219z",
        },
      ],
      data: [
        {
          id: "id5",
        },
      ],
    },
  ],
});
